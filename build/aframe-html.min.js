!function(e){"use strict";class t extends e.Mesh{constructor(t){const n=new o(t),i=new e.PlaneGeometry(.001*n.image.width,.001*n.image.height),s=new e.MeshBasicMaterial({map:n,toneMapped:!1,transparent:!0});function r(e){s.map.dispatchDOMEvent(e)}super(i,s),this.addEventListener("mousedown",r),this.addEventListener("mousemove",r),this.addEventListener("mouseup",r),this.addEventListener("click",r),this.dispose=function(){i.dispose(),s.dispose(),s.map.dispose(),this.removeEventListener("mousedown",r),this.removeEventListener("mousemove",r),this.removeEventListener("mouseup",r),this.removeEventListener("click",r)}}}class o extends e.CanvasTexture{constructor(t){super(s(t)),this.dom=t,this.anisotropy=16,this.encoding=e.sRGBEncoding,this.minFilter=e.LinearFilter,this.magFilter=e.LinearFilter;const o=new MutationObserver((()=>{this.scheduleUpdate||(this.scheduleUpdate=setTimeout((()=>this.update()),16))}));o.observe(t,{attributes:!0,childList:!0,subtree:!0,characterData:!0}),this.observer=o}dispatchDOMEvent(e){e.data&&function(e,t,o,n){const i={clientX:o*e.offsetWidth+e.offsetLeft,clientY:n*e.offsetHeight+e.offsetTop,view:e.ownerDocument.defaultView};window.dispatchEvent(new MouseEvent(t,i));const s=e.getBoundingClientRect();function r(e){if(e.nodeType!==Node.TEXT_NODE&&e.nodeType!==Node.COMMENT_NODE){const s=e.getBoundingClientRect();o>s.left&&o<s.right&&n>s.top&&n<s.bottom&&e.dispatchEvent(new MouseEvent(t,i));for(let t=0;t<e.childNodes.length;t++)r(e.childNodes[t])}}o=o*s.width+s.left,n=n*s.height+s.top,r(e)}(this.dom,e.type,e.data.x,e.data.y)}update(){this.image=s(this.dom),this.needsUpdate=!0,this.scheduleUpdate=null}dispose(){this.observer&&this.observer.disconnect(),this.scheduleUpdate=clearTimeout(this.scheduleUpdate),super.dispose()}}function n(e,t,o,n,i,s){return n<2*s&&(s=n/2),i<2*s&&(s=i/2),e.beginPath(),e.moveTo(t+s,o),e.arcTo(t+n,o,t+n,o+i,s),e.arcTo(t+n,o+i,t,o+i,s),e.arcTo(t,o+i,t,o,s),e.arcTo(t,o,t+n,o,s),e.closePath(),e.fill(),e}const i=new WeakMap;function s(e){const t=document.createRange();function o(e,t,o,n){""!==n&&("uppercase"===e.textTransform&&(n=n.toUpperCase()),d.font=e.fontSize+" "+e.fontFamily,d.textBaseline="top",d.fillStyle=e.color,d.fillText(n,t,o+.1*parseFloat(e.fontSize)))}function s(e,t,o,n,i,s){const r=e[t+"Width"],a=e[t+"Style"],l=e[t+"Color"];"0px"!==r&&"none"!==a&&"transparent"!==l&&"rgba(0, 0, 0, 0)"!==l&&(d.strokeStyle=l,d.lineWidth=parseFloat(r),d.beginPath(),d.moveTo(o,n),d.lineTo(o+i,n+s),d.stroke())}const r=e.getBoundingClientRect();let a;i.has(e)?a=i.get(e):(a=document.createElement("canvas"),a.width=r.width,a.height=r.height);const d=a.getContext("2d"),l=new function(e){const t=[];let o=!1;function n(){if(o&&(o=!1,e.restore()),0===t.length)return;let n=-1/0,i=-1/0,s=1/0,r=1/0;for(let e=0;e<t.length;e++){const o=t[e];n=Math.max(n,o.x),i=Math.max(i,o.y),s=Math.min(s,o.x+o.width),r=Math.min(r,o.y+o.height)}e.save(),e.beginPath(),e.rect(n,i,s-n,r-i),e.clip(),o=!0}return{add:function(e){t.push(e),n()},remove:function(){t.pop(),n()}}}(d);return function e(i,a){let h=0,c=0,p=0,u=0;if(i.nodeType===Node.TEXT_NODE){t.selectNode(i);const e=t.getBoundingClientRect();h=e.left-r.left-.5,c=e.top-r.top-.5,p=e.width,u=e.height,o(a,h,c,i.nodeValue.trim())}else{if(i.nodeType===Node.COMMENT_NODE)return;if(i instanceof HTMLCanvasElement){if("none"===i.style.display)return;d.save();const e=window.devicePixelRatio;d.scale(1/e,1/e),d.drawImage(i,0,0),d.restore()}else{if("none"===i.style.display)return;const e=i.getBoundingClientRect();h=e.left-r.left-.5,c=e.top-r.top-.5,p=e.width,u=e.height;const t=(a=window.getComputedStyle(i)).backgroundColor;i instanceof HTMLInputElement&&i.type,"transparent"!==t&&"rgba(0, 0, 0, 0)"!==t&&(d.fillStyle=t,n(d,h,c,p,u,parseFloat(a.borderRadius)));const m=["borderTop","borderLeft","borderBottom","borderRight"];let f=!0,g=null;for(const e of m){if(g&&(f=f&&a[e+"Width"]&&a[e+"Color"]&&a[e+"Style"]),!f)break;g=e}if(f){const e=parseFloat(a.borderTopWidth);"0px"!==a.borderTopWidth&&"none"!==a.borderTopStyle&&"transparent"!==a.borderTopColor&&"rgba(0, 0, 0, 0)"!==a.borderTopColor&&(d.strokeStyle=a.borderTopColor,d.lineWidth=e,d.stroke())}else s(a,"borderTop",h,c,p,0),s(a,"borderLeft",h,c,0,u),s(a,"borderBottom",h,c+u,p,0),s(a,"borderRight",h+p,c,0,u);if(i instanceof HTMLInputElement){let e=a.accentColor;if(void 0!==e&&"auto"!==e||(e=a.color),"radio"===i.type){const t=2;d.fillStyle="white",n(d,h,c,p,u,u),d.strokeStyle=e,d.lineWidth=1,d.stroke(),i.checked&&(d.fillStyle=e,n(d,h+t,c+t,p-2*t,u-2*t,u))}if("range"===i.type){const[t,o,s]=["min","max","value"].map((e=>parseFloat(i[e]))),r=(s-t)/(o-t)*(p-u);d.fillStyle="#333333",n(d,h,c+.25*u,p,.5*u,.25*u),d.strokeStyle=e,d.lineWidth=1,d.stroke(),d.fillStyle=e,n(d,h,c+.25*u,r+.5*u,.5*u,.25*u),d.fillStyle=e,n(d,h+r,c,u,u,.5*u)}"color"!==i.type&&"text"!==i.type&&"number"!==i.type||(l.add({x:h,y:c,width:p,height:u}),o(a,h+parseInt(a.paddingLeft),c+parseInt(a.paddingTop),i.value),l.remove())}}}const m="auto"===a.overflow||"hidden"===a.overflow;m&&l.add({x:h,y:c,width:p,height:u});for(let t=0;t<i.childNodes.length;t++)e(i.childNodes[t],a);m&&l.remove()}(e),a}AFRAME.registerComponent("html",{schema:{type:"selector"},init(){this.rerender=this.rerender.bind(this)},update(){if(this.remove(),!this.data)return;const e=new t(this.data);this.el.setObject3D("html",e),this.data.addEventListener("input",this.rerender)},rerender(){const e=this.el.getObject3D("html");e&&!e.material.map.scheduleUpdate&&(e.material.map.scheduleUpdate=setTimeout((()=>e.material.map.update()),16))},remove(){this.el.getObject3D("html")&&(this.el.removeObject3D("html"),this.observer.disconnect(),this.data.removeEventListener("change",this.rerender))}})}(THREE);
//# sourceMappingURL=aframe-html.min.js.map
